pipeline {
    agent any

    stages {

        stage("Checkout") {
            steps {
                sh """
                echo "Checkout done - $PWD"
                ls -l
                """
            }
        }

        stage("Building the application") {
            steps {
                sh """
                echo "Building Java application"
                mvn clean package
                echo "======== Building Java Application Completed ======"
                """
            }
        }

        stage("Testing the application") {
            steps {
                sh """
                echo "Testing Java application"
                mvn test
                echo "======== Testing Java Application Completed ======"
                """
            }
        }

        stage("Building the Docker Image") {
            steps {
                sh """
                echo "Building Docker Image"
                docker build -t java-app:latest .
                echo "======== Docker Image Build Completed ======"
                """
            }
        }
    }

    post {
        success {
            echo "Pipeline completed successfully!"
        }
        failure {
            echo "Pipeline failed!"
        }
    }
}
